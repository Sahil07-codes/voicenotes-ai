<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notes to Voice Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    /* 🔥 YOUR ORIGINAL STYLES - untouched */
    :root {
      --primary-color: #1a202c;
      --secondary-color: #2d3748;
      --accent-color-1: #38b2ac;
      --accent-color-2: #4fd1c5;
      --text-color: #e2e8f0;
      --container-bg: rgba(45, 55, 72, 0.75);
      --input-bg: rgba(26, 32, 44, 0.7);
      --input-border: rgba(56, 178, 172, 0.3);
      --input-focus-border: rgba(56, 178, 172, 0.8);
      --input-focus-shadow: rgba(56, 178, 172, 0.5);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      display: flex; justify-content: center; align-items: center;
      min-height: 100vh;
      background-color: var(--primary-color);
      overflow: hidden;
      padding: 1rem;
      position: relative;
    }

    /* Floating Letters Background */
    .letters-background {
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      overflow: hidden; z-index: 1;
      pointer-events: none;
    }
    .letter {
      position: absolute;
      font-weight: bold;
      color: rgba(226, 232, 240, 0.2);
      animation: floatLetters linear infinite;
      user-select: none; white-space: nowrap;
    }
    @keyframes floatLetters {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      20% { opacity: 1; }
      100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
    }

    /* Main container */
    .container {
      width: 100%; max-width: 420px; height: 550px;
      position: relative; z-index: 1000;
    }
    .form-container {
      position: absolute; width: 100%; height: 100%;
      background: var(--container-bg);
      backdrop-filter: blur(25px);
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.5);
      border: 1px solid rgba(255,255,255,0.1);
      transition: opacity 0.6s ease-in-out, transform 0.6s ease-in-out;
    }
    .sign-in-container { opacity: 1; transform: translateX(0); z-index: 2; }
    .sign-up-container { opacity: 0; transform: translateX(30px); z-index: 1; pointer-events: none; }
    .container.show-signup .sign-in-container {
      opacity: 0; transform: translateX(-30px); z-index: 1; pointer-events: none;
    }
    .container.show-signup .sign-up-container {
      opacity: 1; transform: translateX(0); z-index: 2; pointer-events: auto;
    }

    form {
      display: flex; align-items: center; justify-content: center;
      flex-direction: column; padding: 0 3rem; height: 100%; text-align: center;
    }
    h1 { font-weight: 600; margin-bottom: 1.5rem; color: var(--text-color); text-shadow: 0 0 10px var(--accent-color-1); }
    p.form-prompt { font-size: 14px; color: var(--text-color); margin-bottom: 1.5rem; opacity: 0.8; }

    .input-group { width: 100%; position: relative; margin-bottom: 1rem; }
    .input-group i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-color); opacity: 0.5; }
    input {
      background-color: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: 8px;
      padding: 12px 15px 12px 40px;
      width: 100%; color: var(--text-color);
      font-family: 'Poppins', sans-serif;
      transition: all 0.3s ease;
    }
    input::placeholder { color: rgba(226,232,240,0.5); }
    input:focus {
      outline: none; border-color: var(--input-focus-border);
      box-shadow: 0 0 15px var(--input-focus-shadow);
    }

    button {
      border-radius: 8px; border: none;
      background: linear-gradient(90deg, var(--accent-color-2), var(--accent-color-1));
      color: var(--primary-color);
      font-size: 14px; font-weight: bold;
      padding: 12px 45px; letter-spacing: 1px;
      text-transform: uppercase;
      cursor: pointer; margin-top: 1rem;
      box-shadow: 0 5px 15px rgba(56,178,172,0.3);
      transition: all 0.3s ease;
    }
    button:hover { box-shadow: 0 8px 25px rgba(56,178,172,0.5); transform: translateY(-2px); }
    .toggle-link { color: var(--text-color); font-size: 14px; text-decoration: none; margin-top: 20px; cursor: pointer; opacity: 0.8; }
    .toggle-link:hover { opacity: 1; text-decoration: underline; color: var(--accent-color-1); }
  </style>
</head>
<body>
  <!-- Floating Letters Background -->
  <div class="letters-background"></div>
  
  <div class="container" id="container">
    <!-- Sign In Form -->
    <div class="form-container sign-in-container">
      <form id="signInForm">
        <h1>Welcome Back</h1>
        <p class="form-prompt">Login to access your notes</p>
        <div class="input-group">
          <input id="signInEmail" type="email" placeholder="Email" required />
          <i class="fas fa-envelope"></i>
        </div>
        <div class="input-group">
          <input id="signInPassword" type="password" placeholder="Password" required />
          <i class="fas fa-lock"></i>
        </div>
        <button type="submit">Sign In</button>
        <a class="toggle-link" id="signUpLink">Create a new account</a>
      </form>
    </div>

    <!-- Sign Up Form -->
    <div class="form-container sign-up-container">
      <form id="signUpForm">
        <h1>Create Account</h1>
        <p class="form-prompt">And start converting notes to voice</p>
        <div class="input-group">
          <input id="signUpName" type="text" placeholder="Name" required />
          <i class="fas fa-user"></i>
        </div>
        <div class="input-group">
          <input id="signUpEmail" type="email" placeholder="Email" required />
          <i class="fas fa-envelope"></i>
        </div>
        <div class="input-group">
          <input id="signUpPassword" type="password" placeholder="Password" required />
          <i class="fas fa-lock"></i>
        </div>
        <button type="submit">Sign Up</button>
        <a class="toggle-link" id="signInLink">Already have an account? Sign In</a>
      </form>
    </div>
  </div>

  <script>
    const container = document.getElementById('container');
    const signUpLink = document.getElementById('signUpLink');
    const signInLink = document.getElementById('signInLink');
    const signInForm = document.getElementById('signInForm');
    const signUpForm = document.getElementById('signUpForm');

    // Toggle forms
    signUpLink.addEventListener('click', (e) => {
      e.preventDefault();
      container.classList.add('show-signup');
    });
    signInLink.addEventListener('click', (e) => {
      e.preventDefault();
      container.classList.remove('show-signup');
    });

    // Handle Sign In
    signInForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('signInEmail').value;
      const password = document.getElementById('signInPassword').value;

      try {
        const res = await fetch("http://127.0.0.1:8000/login", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: new URLSearchParams({ username: email, password })
        });

       // INSIDE: signInForm.addEventListener('submit', async (e) => { ...

      const data = await res.json();
      if (res.ok) {
        // ✅ 1. Save the token to browser's session storage
        sessionStorage.setItem('accessToken', data.access_token);
        
        // ✅ 2. Redirect to the dashboard
        window.location.href = 'dashboard.html'; 
      } else {
        alert("❌ Login failed: " + data.detail);
      }
// ...
      } catch (err) {
        alert("⚠️ Error connecting to backend");
      }
    });

    // Handle Sign Up
    signUpForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('signUpName').value;
      const email = document.getElementById('signUpEmail').value;
      const password = document.getElementById('signUpPassword').value;

      try {
        const res = await fetch("http://127.0.0.1:8000/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email, password })
        });

        const data = await res.json();
        if (res.ok) {
          alert("🎉 Signup successful! Now login.");
          container.classList.remove('show-signup');
        } else {
          alert("❌ Signup failed: " + data.detail);
        }
      } catch (err) {
        alert("⚠️ Error connecting to backend");
      }
    });

    // Floating letters generator
    const lettersBackground = document.querySelector('.letters-background');
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    function createLetter() {
      const letter = document.createElement('span');
      letter.classList.add('letter');
      letter.innerText = letters[Math.floor(Math.random() * letters.length)];
      letter.style.left = Math.random() * 100 + "vw";
      letter.style.fontSize = (Math.random() * 24 + 14) + "px";
      letter.style.animationDuration = (Math.random() * 6 + 6) + "s";
      lettersBackground.appendChild(letter);
      setTimeout(() => letter.remove(), 12000);
    }
    setInterval(createLetter, 300);
  </script>
</body>
</html>
